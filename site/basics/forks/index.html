<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Emmanouil (Manios) Krasanakis" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Forks - FairBench</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../theme_extend.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Forks";
        var mkdocs_page_input_path = "basics\\forks.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../fairbench.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../quickstart/">Quickstart</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Basics</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Forks</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#fork-definition">Fork definition</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#intersectional-analysis">Intersectional analysis</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../reports/">Reports</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../interactive/">Interactive visualization</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../modelcards/">Stamps and model cards</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/metrics/">Performance metrics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/ml_integration/">ML Integration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/manipulation/">Report manipulation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../advanced/distributed/">Computational branches</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">FairBench</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Basics &raquo;</li>
      <li>Forks</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="forks">Forks</h1>
<p>Forks declare variables with several named values, called branches.
Branches are typically binary arrays of attribute values. 
For instance, there
may a branch for each gender or race to capture which 
data samples exhibit those protected attribute values.</p>
<ol>
<li><a href="#fork-definition">Fork definition</a></li>
<li><a href="#intersectional-analysis">Intersectional analysis</a></li>
</ol>
<h2 id="fork-definition">Fork definition</h2>
<p>Generate forks by passing keyword
arguments to a constructor. 
In the snippet below <code>men</code>, <code>women</code>, and <code>nonbinary</code> are
branch names. Branch values can be anything,
though they will usually be arrays.
Provide any number of branches
with any names and access their values 
like object members, as shown below.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>When working with specific 
<a href="../../advanced/ml_integration/#backend-selection">backends</a>,
branch values are internally converted to appropriate data types
(e.g., arrays or tensors). </p>
</div>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">fairbench</span> <span class="k">as</span> <span class="nn">fb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">sensitive</span> <span class="o">=</span> <span class="n">fb</span><span class="o">.</span><span class="n">Fork</span><span class="p">(</span><span class="n">men</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> 
                    <span class="n">women</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
                    <span class="n">nonbinary</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sensitive</span><span class="o">.</span><span class="n">nonbinary</span><span class="p">)</span>
<span class="c1"># [0, 0, 0, 0, 1]</span>
</code></pre></div>
<p>To set some (or all) branches programmatically
pass a dictionary as a positional argument like so:
<div class="highlight"><pre><span></span><code><span class="n">sensitive</span> <span class="o">=</span> <span class="n">fb</span><span class="o">.</span><span class="n">Fork</span><span class="p">({</span><span class="s2">&quot;non-binary&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])},</span> 
                    <span class="n">men</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> 
                    <span class="n">women</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</code></pre></div></p>
<p>To create forks by analysing categorical values found in iterables 
prepend the latter with the <code>categories@</code> operator.
For example, the following code snippet
creates two branches <code>genderMan,genderWoman</code> and stores binary
membership to each of those. </p>
<div class="highlight"><pre><span></span><code><span class="n">fork</span> <span class="o">=</span> <span class="n">fb</span><span class="o">.</span><span class="n">Fork</span><span class="p">(</span><span class="n">gender</span><span class="o">=</span><span class="n">fb</span><span class="o">.</span><span class="n">categories</span><span class="o">@</span><span class="p">[</span><span class="s2">&quot;Man&quot;</span><span class="p">,</span> <span class="s2">&quot;Woman&quot;</span><span class="p">,</span> <span class="s2">&quot;Man&quot;</span><span class="p">,</span> <span class="s2">&quot;Woman&quot;</span><span class="p">,</span> <span class="s2">&quot;Nonbin&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fork</span><span class="p">)</span>
<span class="c1"># genderMan: [1, 0, 1, 0, 0]</span>
<span class="c1"># genderWoman: [0, 1, 0, 1, 0]</span>
<span class="c1"># genderNonbin: [0, 0, 0, 0, 1]</span>
</code></pre></div>
<p>Add the outcomes of any number of 
category analyses to a fork. Use
positional arguments
(instead of named keyword arguments, such as <code>gender</code> in the above example)
to avoid prepending the keyword argument's name to branch names.
Any iterable can be analysed into categories instead of a list, 
including categorical tensors or arrays.</p>
<h2 id="intersectional-analysis">Intersectional analysis</h2>
<p>For more than one sensitive
attribute, add the branches you would declare for
every attribute more branches of the same fork.
For instance, the following is a valid fork that considers three
gender attribute values and one binary sensitive attribute 
value for young vs old people:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">sensitive</span> <span class="o">=</span> <span class="n">fb</span><span class="o">.</span><span class="n">Fork</span><span class="p">(</span><span class="n">fb</span><span class="o">.</span><span class="n">categories</span><span class="o">@</span><span class="p">[</span><span class="s2">&quot;Man&quot;</span><span class="p">,</span> <span class="s2">&quot;Woman&quot;</span><span class="p">,</span> <span class="s2">&quot;Man&quot;</span><span class="p">,</span> <span class="s2">&quot;Woman&quot;</span><span class="p">,</span> <span class="s2">&quot;Nonbin&quot;</span><span class="p">],</span> 
                    <span class="n">IsOld</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
<span class="c1"># Man: [1, 0, 1, 0, 0]</span>
<span class="c1"># Woman: [0, 1, 0, 1, 0]</span>
<span class="c1"># Nonbin: [0, 0, 0, 0, 1]</span>
<span class="c1"># IsOld0.0 [1, 0, 0, 0, 1]</span>
<span class="c1"># IsOld1.0 [0, 1, 1, 1, 0]</span>
</code></pre></div>
<p>For more than one sensitive attributes,
branches capturing the values of different attributes
will have overlapping non-zeroes.
Thus, you might want to consider intersectional 
instead of more naive definitions of fairness
by creating all branch combinations with at least
one data sample per:</p>
<div class="highlight"><pre><span></span><code><span class="n">sensitive</span> <span class="o">=</span> <span class="n">sensitive</span><span class="o">.</span><span class="n">intersectional</span><span class="p">()</span>
</code></pre></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../quickstart/" class="btn btn-neutral float-left" title="Quickstart"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../reports/" class="btn btn-neutral float-right" title="Reports">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../quickstart/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../reports/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../mathjax.js" defer></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
